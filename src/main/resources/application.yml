spring:
  ai:
    mcp:
      server:
        name: mcp-zap-server
        version: 0.3.0
        instructions: "Use this server to interact with the ZAP API for security testing."
        protocol: STREAMABLE
        resource-change-notification: true
        tool-change-notification: true
        prompt-change-notification: true
        streamable-http:
          mcp-endpoint: /mcp
          keep-alive-interval: 30s
        type: ASYNC

logging:
  level:
    mcp.server.zap.service: DEBUG
    mcp.server.zap.configuration: INFO
    
server:
  port: 7456

# MCP Server Security Configuration
# Uses Bearer token authentication: Authorization: Bearer <your-api-key>
mcp:
  server:
    security:
      mode: ${MCP_SECURITY_MODE:api-key}
      enabled: ${MCP_SECURITY_ENABLED:true}
    apiKey: ${MCP_API_KEY:changeme-default-key}
    auth:
      apiKeys:
        - clientId: ${MCP_CLIENT_ID:default-client}
          key: ${MCP_API_KEY:changeme-default-key}
          description: ${MCP_CLIENT_DESCRIPTION:Default MCP client}

# ZAP Configuration
zap:
  server:
    url: ${ZAP_API_URL:localhost}
    port: ${ZAP_API_PORT:8091}
    apiKey: ${ZAP_API_KEY}
  
  scan:
    limits:
      maxActiveScanDurationInMins: ${ZAP_MAX_ACTIVE_SCAN_DURATION:30}
      maxSpiderScanDurationInMins: ${ZAP_MAX_SPIDER_SCAN_DURATION:15}
      maxConcurrentActiveScans: ${ZAP_MAX_CONCURRENT_ACTIVE_SCANS:3}
      maxConcurrentSpiderScans: ${ZAP_MAX_CONCURRENT_SPIDER_SCANS:5}
      threadPerHost: ${ZAP_THREAD_PER_HOST:10}
      hostPerScan: ${ZAP_HOST_PER_SCAN:5}
      connectionTimeoutInSecs: ${ZAP_CONNECTION_TIMEOUT:60}
      spiderThreadCount: ${ZAP_SPIDER_THREAD_COUNT:5}
      spiderMaxDepth: ${ZAP_SPIDER_MAX_DEPTH:10}
    active:
      enableAllScanners: true
    url:
      allowLocalhost: ${ZAP_ALLOW_LOCALHOST:false}
      allowPrivateNetworks: ${ZAP_ALLOW_PRIVATE_NETWORKS:false}
      whitelist: ${ZAP_URL_WHITELIST:}
      blacklist: ${ZAP_URL_BLACKLIST:localhost,127.0.0.1,0.0.0.0,169.254.0.0/16,10.0.0.0/8,172.16.0.0/12,192.168.0.0/16}
  
  report:
    directory: ${ZAP_REPORT_DIRECTORY:/zap/wrk}
  
  initialization:
    userAgent: ${ZAP_USER_AGENT:Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36}
    connectionTimeoutInSecs: ${ZAP_INIT_CONNECTION_TIMEOUT:300}
    dnsTtlSuccessfulQueries: ${ZAP_DNS_TTL:60}

management:
  endpoints:
    web:
      exposure:
        include: health,info
  endpoint:
    health:
      show-details: always
