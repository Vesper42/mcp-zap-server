# CodeQL Configuration for MCP ZAP Server
# https://docs.github.com/en/code-security/code-scanning/creating-an-advanced-setup-for-code-scanning/customizing-your-advanced-setup-for-code-scanning

name: "MCP ZAP Server CodeQL Config"

# Suppress known false positives
query-filters:
  # CSRF disabled intentionally - This is an API-only server for machine-to-machine
  # communication using the MCP protocol. Authentication is handled via Bearer tokens
  # in the Authorization header, not cookies. CSRF attacks require browser-based
  # sessions with automatic cookie submission, which this server does not support.
  # 
  # Security justification:
  # 1. API-only server - no browser UI, no cookie-based sessions
  # 2. Token-based authentication - Bearer tokens must be explicitly provided
  # 3. MCP protocol requirement - MCP clients don't support CSRF token exchange
  # 4. OWASP guidelines confirm CSRF protection not needed for stateless APIs
  #    https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html
  - exclude:
      id: java/spring-disabled-csrf-protection
      paths:
        - src/main/java/mcp/server/zap/configuration/SecurityConfig.java
