# =================================================================
# MCP ZAP Server Environment Configuration
# =================================================================
# Copy this file to .env and update with your values
# DO NOT commit .env to version control
# =================================================================

# -----------------------------
# ZAP Configuration
# -----------------------------
# API key for ZAP authentication (required)
# Generate a strong random key: openssl rand -hex 32
ZAP_API_KEY=your-secure-zap-api-key-here

# ZAP workspace directory on host machine
# This directory will be mounted to ZAP container for storing reports and data
LOCAL_ZAP_WORKPLACE_FOLDER=./zap-data

# ZAP Memory allocation (default: 4G)
ZAP_MEMORY=4G

# -----------------------------
# MCP Server Security
# -----------------------------

# Authentication Mode: none or api-key
# - none: No authentication (development/testing ONLY - NOT SECURE)
# - api-key: API key authentication (recommended)
MCP_SECURITY_MODE=api-key

# Enable/disable MCP security (true/false)
# WARNING: Set to false only in isolated development environments
MCP_SECURITY_ENABLED=true

# API key for MCP server authentication (required for api-key mode)
# Generate a strong random key: openssl rand -hex 32
MCP_API_KEY=your-secure-mcp-api-key-here

# Client ID for default MCP client
MCP_CLIENT_ID=default-client
MCP_CLIENT_DESCRIPTION="Default MCP client"

# -----------------------------
# Scan Limits and Timeouts
# -----------------------------
# Maximum duration for active scans in minutes (0 = no limit)
ZAP_MAX_ACTIVE_SCAN_DURATION=30

# Maximum duration for spider scans in minutes (0 = no limit)
ZAP_MAX_SPIDER_SCAN_DURATION=15

# Maximum number of concurrent active scans
ZAP_MAX_CONCURRENT_ACTIVE_SCANS=3

# Maximum number of concurrent spider scans
ZAP_MAX_CONCURRENT_SPIDER_SCANS=5

# Number of threads per host for active scanning
ZAP_THREAD_PER_HOST=10

# Maximum number of hosts per scan (0 = no limit)
ZAP_HOST_PER_HOST=5

# Connection timeout in seconds
ZAP_CONNECTION_TIMEOUT=60

# Spider scan thread count
ZAP_SPIDER_THREAD_COUNT=5

# Spider maximum depth
ZAP_SPIDER_MAX_DEPTH=10

# -----------------------------
# URL Security Configuration
# -----------------------------
# Allow scanning localhost (true/false)
# WARNING: Enable only in secure, isolated environments
ZAP_ALLOW_LOCALHOST=false

# Allow scanning private network addresses (true/false)
# WARNING: Enable only in secure, isolated environments
ZAP_ALLOW_PRIVATE_NETWORKS=false

# Whitelist of allowed domains (comma-separated, supports wildcards)
# Example: example.com,*.test.com,demo.org
# If set, only these domains can be scanned (takes precedence over blacklist)
ZAP_URL_WHITELIST=

# Blacklist of blocked domains (comma-separated)
# Default includes localhost and private network ranges
ZAP_URL_BLACKLIST=localhost,127.0.0.1,0.0.0.0,169.254.0.0/16,10.0.0.0/8,172.16.0.0/12,192.168.0.0/16

# Report directory inside container
ZAP_REPORT_DIRECTORY=/zap/wrk
